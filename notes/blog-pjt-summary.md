---
title: GitHub Pages上にブログを構築する (Next.js)
tags: [next.js]
published_at: 2022-07-14T17:53:53+09:00[Asia/Tokyo]
---

うおおおおおおおおおお！！！先々週までこんな感じだったブログが…

![2週間前のスクショ](blog-20220702.png "7月2日当時のスクショ。文字が書いてあるのでブログ")

原稿パーサーとReact側の改善により、まともになりました。

![本日のスクショ](blog-20220715.png "デザインのクオリティはさておき、ブログっぽい")

## tl;dr;

GitHubにほぼ頼りきりのブログができたよ

### 使った技術スタック

-   Next.js (SSG)
-   PEG.js (自前マークダウン風のパーサー)
-   GitHub Action ビルド
-   GitHub Pages ホスト
-   Cloudflare（現状ただ置いただけ）

## この2週間の進捗

まず前半はパーサーの改良に集中しました。パーサー（あるいはマークダウンそのもの）の仕様が決まれば、とにかく記事は書けますもんね。その作業の詳細は[この記事](/blog-pjt-005-markdown)にあります。

見た目はけっこう変わりましたが、[実際の原稿ファイル](https://raw.githubusercontent.com/stakme/stakme.github.io/6aa9f3033c5ea3ed967abb0e03b1a1838183c64f/notes/blog-pjt-top-page.md)はほとんど同じです。日付文字列のフォーマットがちょっと変わったくらいですね。冒頭だけ抜き出すと、こんな感じで書いています。

```
---
summary: トップページつくった
tags: [next.js]
published_at: 2022-07-02T00:29:51+09:00[Asia/Tokyo]
---

トップページに遷移できるようになりました。まるでWebサイトみたいだ…

### pjt.init

-   goal: サイト利用者からみて、コンテンツが現実的に利用可能な状態する
-   measurable objectives:
    1. stak.me にアクセスすると、直近の記事タイトル、本文、投稿日時が表示されている
    1. 各記事にサイト名が表示されている
    1. トップと記事でリンク遷移できる
```

この原稿、一見すると普通のマークダウン風ですが、あくまで「マークダウン風」の別物です。パーサー自体の実装と、その後の処理の流れから、通常の世界には存在しないルールがあります。例えば…

-   記事冒頭はYAML形式のメタデータでなければならない
-   メタデータは特定キーを含む辞書でなければならない
-   `![わんわん🐶](dog.jpeg)` と記載すると `/{記事ID}/dog.jpeg` にある画像を表示する
-   さらに `![@わんわん🐶](dog.jpeg)` と記載すると「この記事を代表する画像」として取り扱う（トップページやTwitter Cardに出したりする）

未実装の機能も色々あります。文字列を強調する `**` だとか、打ち消し線を乗せる `~~` などは実装されていません。テーブル記法とかもないです。`pre`タグに書かれたコードにいい感じのシンタックスハイライトを当てる機能とかもないです。

テーブル記法は多分しばらく（一生かも）対応しない気がしますが、シンタックスハイライトは早めに入れたいですね。ある方が見やすいですもんね。

![@わんわん🐶](dog.jpeg "記事と何の関係もないが、顔がいいので掲載された我が家の犬")
